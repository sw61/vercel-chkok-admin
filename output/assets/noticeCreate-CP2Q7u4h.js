import{r as n,j as e,a1 as O,a2 as $,a3 as R,a4 as G,a5 as z,a6 as _,a7 as K,o as V,a8 as X,k as W,C as J,B as Q,I as Y,y as w,d as M,z as Z}from"./index-CJ34pbwU.js";import{E as ee,b as te,i as se,s as re,h as ae,a as ne,d as E,l as oe,q as ce,c as ie,e as de,f as le,u as ue,o as me,g as pe,j as he,k as fe,M as xe,r as be}from"./server.browser-CI6EAX34.js";import{C as ge}from"./chevron-left-CIzyo49A.js";function ke(t){const a=n.useRef({value:t,previous:t});return n.useMemo(()=>(a.current.value!==t&&(a.current.previous=a.current.value,a.current.value=t),a.current.previous),[t])}var S="Checkbox",[Ce,Se]=O(S),[ve,P]=Ce(S);function je(t){const{__scopeCheckbox:a,checked:c,children:f,defaultChecked:i,disabled:r,form:b,name:m,onCheckedChange:d,required:x,value:g="on",internal_do_not_use_render:p}=t,[h,y]=G({prop:c,defaultProp:i??!1,onChange:d,caller:S}),[k,C]=n.useState(null),[N,l]=n.useState(null),s=n.useRef(!1),u=k?!!b||!!k.closest("form"):!0,o={checked:h,disabled:r,setChecked:y,control:k,setControl:C,name:m,form:b,value:g,hasConsumerStoppedPropagationRef:s,required:x,defaultChecked:j(i)?!1:i,isFormControl:u,bubbleInput:N,setBubbleInput:l};return e.jsx(ve,{scope:a,...o,children:ye(p)?p(o):f})}var B="CheckboxTrigger",T=n.forwardRef(({__scopeCheckbox:t,onKeyDown:a,onClick:c,...f},i)=>{const{control:r,value:b,disabled:m,checked:d,required:x,setControl:g,setChecked:p,hasConsumerStoppedPropagationRef:h,isFormControl:y,bubbleInput:k}=P(B,t),C=z(i,g),N=n.useRef(d);return n.useEffect(()=>{const l=r?.form;if(l){const s=()=>p(N.current);return l.addEventListener("reset",s),()=>l.removeEventListener("reset",s)}},[r,p]),e.jsx(R.button,{type:"button",role:"checkbox","aria-checked":j(d)?"mixed":d,"aria-required":x,"data-state":F(d),"data-disabled":m?"":void 0,disabled:m,value:b,...f,ref:C,onKeyDown:_(a,l=>{l.key==="Enter"&&l.preventDefault()}),onClick:_(c,l=>{p(s=>j(s)?!0:!s),k&&y&&(h.current=l.isPropagationStopped(),h.current||l.stopPropagation())})})});T.displayName=B;var L=n.forwardRef((t,a)=>{const{__scopeCheckbox:c,name:f,checked:i,defaultChecked:r,required:b,disabled:m,value:d,onCheckedChange:x,form:g,...p}=t;return e.jsx(je,{__scopeCheckbox:c,checked:i,defaultChecked:r,disabled:m,required:b,onCheckedChange:x,name:f,form:g,value:d,internal_do_not_use_render:({isFormControl:h})=>e.jsxs(e.Fragment,{children:[e.jsx(T,{...p,ref:a,__scopeCheckbox:c}),h&&e.jsx(D,{__scopeCheckbox:c})]})})});L.displayName=S;var A="CheckboxIndicator",q=n.forwardRef((t,a)=>{const{__scopeCheckbox:c,forceMount:f,...i}=t,r=P(A,c);return e.jsx($,{present:f||j(r.checked)||r.checked===!0,children:e.jsx(R.span,{"data-state":F(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:a,style:{pointerEvents:"none",...t.style}})})});q.displayName=A;var U="CheckboxBubbleInput",D=n.forwardRef(({__scopeCheckbox:t,...a},c)=>{const{control:f,hasConsumerStoppedPropagationRef:i,checked:r,defaultChecked:b,required:m,disabled:d,name:x,value:g,form:p,bubbleInput:h,setBubbleInput:y}=P(U,t),k=z(c,y),C=ke(r),N=K(f);n.useEffect(()=>{const s=h;if(!s)return;const u=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(u,"checked").set,I=!i.current;if(C!==r&&v){const H=new Event("click",{bubbles:I});s.indeterminate=j(r),v.call(s,j(r)?!1:r),s.dispatchEvent(H)}},[h,C,r,i]);const l=n.useRef(j(r)?!1:r);return e.jsx(R.input,{type:"checkbox","aria-hidden":!0,defaultChecked:b??l.current,required:m,disabled:d,name:x,value:g,form:p,...a,tabIndex:-1,ref:k,style:{...a.style,...N,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});D.displayName=U;function ye(t){return typeof t=="function"}function j(t){return t==="indeterminate"}function F(t){return j(t)?"indeterminate":t?"checked":"unchecked"}function Ne({className:t,...a}){return e.jsx(L,{"data-slot":"checkbox",className:V("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:e.jsx(q,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(X,{className:"size-3.5"})})})}function Re(){const[t,a]=n.useState(""),[c,f]=n.useState(""),[i,r]=n.useState(!1),[b,m]=n.useState(!1),[d,x]=n.useState(null),[g,p]=n.useState(null),h=W(),y=async()=>{if(!t){w.error("제목을 입력해주세요.");return}if(!c){w.error("내용을 입력해주세요.");return}const s=e.jsx(xe,{rehypePlugins:[be],children:c}),u=fe.renderToStaticMarkup(s);try{await M.post("/api/admin/notices",{title:t,content:u,isMust:i}),w.success("문서가 생성되었습니다."),h("/notices")}catch(o){console.error("문서 생성 오류:",o),w.error("문서 생성에 실패했습니다.")}},k=async s=>{const u=s.name.split(".").pop()?.toLowerCase()||"jpg";try{w.info("이미지 업로드 중 입니다...");const v=(await M.post("/api/images/kokpost/presigned-url",{fileExtension:u})).data.data.presignedUrl.split("?")[0],I=s.type||"image/jpeg";return await Z.put(v,s,{headers:{"Content-Type":I}}),v}catch(o){throw w.error("이미지 업로드에 실패했습니다."),o}},C=(s,u)=>{x({url:s,name:u}),m(!0)},N=()=>{if(!d||!g)return;const{url:s,name:u}=d,o=`![${u}](${s})`;g.replaceSelection(o),m(!1),w.success("이미지가 삽입 되었습니다."),x(null)},l={name:"imageUpload",keyCommand:"imageUpload",buttonProps:{"aria-label":"Add image (ctrl + k)"},icon:e.jsx("svg",{width:"13",height:"13",viewBox:"0 0 20 20",children:e.jsx("path",{fill:"currentColor",d:"M15 9c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm4-7H1c-.55 0-1 .45-1 1v14c0 .55.45 1 1 1h18c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 13l-6-5-2 2-4-5-4 8V4h16v11z"})}),execute:async(s,u)=>{p(u);const o=document.createElement("input");o.type="file",o.accept="image/*",o.onchange=async()=>{if(o.files&&o.files[0]){const v=o.files[0],I=await k(v);C(I,v.name)}},o.click()}};return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-4",children:e.jsx(ge,{onClick:()=>h("/notices"),className:"cursor-pointer"})}),e.jsx(J,{children:e.jsxs("div",{className:"flex flex-col items-center px-6",children:[e.jsxs("div",{className:"w-full","data-color-mode":"light",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"mb-2 flex justify-between items-center",children:[e.jsx("div",{className:"ck-body-2 flex flex-col justify-end",children:"제목"}),e.jsx(Q,{onClick:y,className:"px-4 py-2",variant:"outline",children:"생성"})]}),e.jsx(Y,{value:t,onChange:s=>a(()=>s.target.value),placeholder:"제목을 입력하세요",className:"w-full"})]}),e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(Ne,{id:"isMust",checked:i,onCheckedChange:s=>r(s)}),e.jsx("label",{htmlFor:"isMust",className:"text-sm font-medium text-ck-gray-700",children:"중요 공지사항"})]}),e.jsx(ee,{value:c,onChange:f,height:700,preview:"live",commands:[te,se,re,ae,ne,E,oe,ce,ie,de,le,E,l,E,ue,me,pe,E,he]})]}),b&&e.jsx("div",{className:"absolute inset-0 z-10 flex h-full w-full items-center justify-center backdrop-blur-sm",children:e.jsxs("div",{className:"w-96 rounded-lg border bg-white p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"이미지 미리보기"}),e.jsx("div",{className:"rounded-lg border bg-gray-50 p-2",children:e.jsx("img",{src:d?.url,alt:d?.name,className:"h-auto max-w-full"})})]}),e.jsx("div",{className:"mb-6 grid grid-cols-2 gap-4"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{m(!1),x(null)},className:"flex-1 rounded-md bg-gray-200 px-4 py-2 text-gray-700 transition-colors hover:bg-gray-300",children:"취소"}),e.jsx("button",{onClick:N,className:"flex-1 rounded-md bg-blue-500 px-4 py-2 text-white transition-colors hover:bg-blue-700",children:"설정"})]})]})})]})})]})}export{Re as default};
